<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>بلاگ تخصصی ساختمان</title>
    <style>
        body { font-family: sans-serif; direction: rtl; padding: 20px; }
        .posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .post-card { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; text-decoration: none; color: #333; }
        .post-card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .post-card img { width: 100%; height: 200px; object-fit: cover; }
        .post-card-content { padding: 15px; }
        .loader { text-align: center; font-size: 20px; padding: 50px; }
    </style>
</head>
<body>
    <h1>بلاگ تخصصی ساختمان</h1>
    <main id="posts-grid">
        <div class="loader">در حال بارگذاری پست‌ها...</div>
    </main>

    <script>
        // URL وب اپلیکیشنی که در گام قبل کپی کردید را اینجا قرار دهید
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwaCP-kY-LLWh_v3gNr2gu13Zd9Mfkh_s6mjcNzQxVGmyrl-i63fBheHi2kG5y0e1Ub/exec";

        document.addEventListener("DOMContentLoaded", () => {
            fetchPosts();
        });

        async function fetchPosts() {
            const postsGrid = document.getElementById("posts-grid");
            try {
                const response = await fetch(WEB_APP_URL);
                if (!response.ok) throw new Error("خطا در دریافت اطلاعات.");
                
                const posts = await response.json();

                // پاک کردن پیام "در حال بارگذاری"
                postsGrid.innerHTML = "";

                if (posts.length === 0) {
                    postsGrid.innerHTML = "<p>پستی برای نمایش وجود ندارد.</p>";
                    return;
                }

                posts.forEach(post => {
                    const postCard = `
                        <a href="post.html?id=${post.id}" class="post-card">
                            <img src="${post.imageURL}" alt="${post.title}">
                            <div class="post-card-content">
                                <h3>${post.title}</h3>
                                <p>${post.excerpt}</p>
                                <small>نویسنده: ${post.author} | تاریخ: ${new Date(post.date).toLocaleDateString('fa-IR')}</small>
                            </div>
                        </a>
                    `;
                    postsGrid.innerHTML += postCard;
                });

            } catch (error) {
                postsGrid.innerHTML = `<p>متاسفانه مشکلی رخ داده است: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
