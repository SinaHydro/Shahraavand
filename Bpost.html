<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محتوای پست</title>
     <style>
        body { font-family: sans-serif; direction: rtl; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
        .post-image { width: 100%; max-height: 400px; object-fit: cover; border-radius: 8px; }
        .loader { text-align: center; font-size: 20px; padding: 50px; }
        .post-content { line-height: 1.8; }
        a { color: #1a73e8; }
    </style>
</head>
<body>
    <main id="post-container" class="container">
        <div class="loader">در حال بارگذاری محتوای پست...</div>
    </main>

    <script>
        // URL وب اپلیکیشنی که در گام قبل کپی کردید را اینجا قرار دهید
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwaCP-kY-LLWh_v3gNr2gu13Zd9Mfkh_s6mjcNzQxVGmyrl-i63fBheHi2kG5y0e1Ub/exec";
        
        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const postId = params.get('id');

            if (postId) {
                fetchSinglePost(postId);
            } else {
                const postContainer = document.getElementById("post-container");
                postContainer.innerHTML = "<h1>خطا: شناسه پست مشخص نشده است.</h1>";
            }
        });

        async function fetchSinglePost(id) {
            const postContainer = document.getElementById("post-container");
            const urlWithId = `${WEB_APP_URL}?id=${id}`;
            
            try {
                const response = await fetch(urlWithId);
                if (!response.ok) throw new Error("پست یافت نشد.");

                const post = await response.json();

                if (post.error) {
                    throw new Error(post.error);
                }

                document.title = post.title; // عنوان صفحه را آپدیت می‌کند
                
                postContainer.innerHTML = `
                    <h1>${post.title}</h1>
                    <p><strong>نویسنده: ${post.author} | تاریخ: ${new Date(post.date).toLocaleDateString('fa-IR')}</strong></p>
                    <img src="${post.imageURL}" alt="${post.title}" class="post-image">
                    <hr>
                    <div class="post-content">
                        ${post.content}
                    </div>
                    <a href="index.html">بازگشت به صفحه اصلی</a>
                `;

            } catch (error) {
                postContainer.innerHTML = `<h1>خطا: ${error.message}</h1> <a href="index.html">بازگشت به صفحه اصلی</a>`;
            }
        }
    </script>
</body>
</html>
